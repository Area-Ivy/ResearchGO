# Traefik 静态配置
# API 网关 - ResearchGO

# API 和 Dashboard
api:
  dashboard: true
  insecure: true  # 开发环境，生产环境应使用 HTTPS

# 入口点配置
entryPoints:
  # API 网关主入口
  web:
    address: ":8080"
  # Dashboard/API 入口 (Traefik 内部使用 "traefik" 这个名称)
  traefik:
    address: ":8081"

# 提供者配置
providers:
  # 文件配置 - 路由规则和中间件
  file:
    directory: /etc/traefik/dynamic
    watch: true  # 自动监听配置变化
  
  # Consul Catalog - 服务发现
  consulCatalog:
    endpoint:
      address: "consul:8500"
      scheme: "http"
    # 只发现有 traefik.enable=true 标签的服务
    exposedByDefault: false
    # 健康检查
    watch: true
    # 默认使用服务名作为路由
    defaultRule: "PathPrefix(`/api/{{ .Name | trimPrefix \"researchgo-\" }}`)"

# 日志配置
log:
  level: INFO
  format: common

# 访问日志
accessLog:
  format: common
  filePath: ""  # 输出到 stdout

